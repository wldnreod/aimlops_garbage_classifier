# ğŸ—‘ï¸ AI ì“°ë ˆê¸° ë¶„ë¥˜ ì‹œìŠ¤í…œ

> Hugging Face ëª¨ë¸ì„ í™œìš©í•œ ì“°ë ˆê¸° ìë™ ë¶„ë¥˜ MLOps í”„ë¡œì íŠ¸

[![Cloud Run](https://img.shields.io/badge/Google%20Cloud-Run-4285F4?logo=googlecloud)](https://garbage-classifier-16970477973.asia-northeast3.run.app)
[![Vercel](https://img.shields.io/badge/Vercel-Live-000000?logo=vercel)](https://web-b07whixjy-wldnrs-projects.vercel.app)
[![Expo](https://img.shields.io/badge/Expo-APK-000020?logo=expo)](https://expo.dev/artifacts/eas/vDoX9CV6gFSnDH8t9TjrCB.apk)

## ğŸ“‹ í”„ë¡œì íŠ¸ ê°œìš”

ì‚¬ì§„ì„ ì°ìœ¼ë©´ AIê°€ ìë™ìœ¼ë¡œ ì“°ë ˆê¸° ì¢…ë¥˜ë¥¼ ë¶„ë¥˜í•´ì£¼ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤. 
**Hugging Face ëª¨ë¸**ì„ **Cloud Run**ì— ë°°í¬í•˜ê³ , **ì›¹**ê³¼ **ëª¨ë°”ì¼ ì•±**ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ğŸ¯ ì£¼ìš” ê¸°ëŠ¥
- ğŸ“¸ **ì´ë¯¸ì§€ ì—…ë¡œë“œ** â†’ AIê°€ ì“°ë ˆê¸° ì¹´í…Œê³ ë¦¬ ìë™ ë¶„ë¥˜
- ğŸŒ **ì›¹ ë°ëª¨**: ë¸Œë¼ìš°ì €ì—ì„œ ë°”ë¡œ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥
- ğŸ“± **ëª¨ë°”ì¼ ì•±**: Android APK ë‹¤ìš´ë¡œë“œ ë° ì„¤ì¹˜ ê°€ëŠ¥
- â˜ï¸ **í´ë¼ìš°ë“œ ë°°í¬**: Google Cloud Runìœ¼ë¡œ 24/7 ì„œë¹„ìŠ¤

### ğŸ¤– ì‚¬ìš©í•œ AI ëª¨ë¸
- **ëª¨ë¸ëª…**: [`yangy50/garbage-classification`](https://huggingface.co/yangy50/garbage-classification)
- **ì¶œì²˜**: Hugging Face Model Hub
- **ëª¨ë¸ í¬ê¸°**: 343MB
- **ë¶„ë¥˜ ì¹´í…Œê³ ë¦¬**: cardboard, glass, metal, paper, plastic, trash ë“±

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ì‚¬ìš©ì    â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚  Web / Mobile   â”‚â”€â”€â”€â”€â”€â”€â–¶â”‚   Cloud Run    â”‚
â”‚  (ì´ë¯¸ì§€)   â”‚      â”‚   Frontend      â”‚ HTTP  â”‚   (FastAPI)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                        â”‚
                                                        â–¼
                                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                â”‚  Hugging Face   â”‚
                                                â”‚  AI Model (343MB)â”‚
                                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ ë°°í¬ëœ ì„œë¹„ìŠ¤

| ì„œë¹„ìŠ¤ | URL | ì„¤ëª… |
|--------|-----|------|
| ğŸ”— **API** | https://garbage-classifier-16970477973.asia-northeast3.run.app | FastAPI REST API (Cloud Run) |
| ğŸŒ **ì›¹ ë°ëª¨** | https://web-b07whixjy-wldnrs-projects.vercel.app | ë¸Œë¼ìš°ì € ê¸°ë°˜ ì›¹ ì•± (Vercel) |
| ğŸ“± **ëª¨ë°”ì¼ APK** | [ë‹¤ìš´ë¡œë“œ ë§í¬](https://expo.dev/artifacts/eas/vDoX9CV6gFSnDH8t9TjrCB.apk) | Android ì•± ì„¤ì¹˜ íŒŒì¼ |

### API ì‚¬ìš© ì˜ˆì‹œ

```bash
# Health Check
curl https://garbage-classifier-16970477973.asia-northeast3.run.app/health

# ì´ë¯¸ì§€ ë¶„ë¥˜
curl -X POST "https://garbage-classifier-16970477973.asia-northeast3.run.app/predict" \
  -F "file=@garbage.jpg"
```

**ì‘ë‹µ ì˜ˆì‹œ:**
```json
{
  "success": true,
  "prediction": {
    "label": "cardboard",
    "score": 0.8542
  },
  "inference_time_ms": 234.5
}
```

## ğŸ’» í•µì‹¬ ì½”ë“œ ì„¤ëª…

### 1ï¸âƒ£ AI ëª¨ë¸ ë¡œë“œ (`model.py`)

```python
from transformers import AutoModelForImageClassification
import torch

class GarbageClassifier:
    def __init__(self):
        # Hugging Faceì—ì„œ ëª¨ë¸ ë‹¤ìš´ë¡œë“œ
        self.model = AutoModelForImageClassification.from_pretrained(
            "yangy50/garbage-classification"
        )
        self.model.eval()
    
    def predict(self, image):
        # ì´ë¯¸ì§€ë¥¼ í…ì„œë¡œ ë³€í™˜
        inputs = self.transform(image).unsqueeze(0)
        
        # AI ì¶”ë¡  ì‹¤í–‰
        with torch.no_grad():
            outputs = self.model(inputs)
            probabilities = torch.nn.functional.softmax(outputs.logits, dim=1)
        
        # ê°€ì¥ ë†’ì€ í™•ë¥ ì˜ ì¹´í…Œê³ ë¦¬ ë°˜í™˜
        predicted_class = probabilities.argmax().item()
        confidence = probabilities[0][predicted_class].item()
        
        return {
            "label": self.model.config.id2label[predicted_class],
            "score": confidence
        }
```

### 2ï¸âƒ£ FastAPI ì„œë²„ (`main.py`)

```python
from fastapi import FastAPI, File, UploadFile
from fastapi.middleware.cors import CORSMiddleware
from model import GarbageClassifier

app = FastAPI()

# CORS ì„¤ì • (ì›¹/ëª¨ë°”ì¼ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë„ë¡)
app.add_middleware(
    CORSMiddleware,
    allow_origins=["*"],
    allow_methods=["*"],
    allow_headers=["*"]
)

# AI ëª¨ë¸ ë¡œë“œ
classifier = GarbageClassifier()

@app.post("/predict")
async def predict(file: UploadFile = File(...)):
    # ì—…ë¡œë“œëœ ì´ë¯¸ì§€ ì½ê¸°
    image = Image.open(file.file)
    
    # AI ëª¨ë¸ë¡œ ë¶„ë¥˜
    result = classifier.predict(image)
    
    return {"success": True, "prediction": result}
```

### 3ï¸âƒ£ Docker ë°°í¬ (`Dockerfile`)

```dockerfile
FROM python:3.11-slim

# ì˜ì¡´ì„± ì„¤ì¹˜
COPY requirements.txt .
RUN pip install --no-cache-dir -r requirements.txt

# ì•± ì½”ë“œ ë³µì‚¬
COPY . .

# FastAPI ì„œë²„ ì‹¤í–‰
CMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8080"]
```

### 4ï¸âƒ£ ëª¨ë°”ì¼ ì•± (`mobile/App.js`)

```javascript
import * as ImagePicker from 'expo-image-picker';

export default function App() {
  const [result, setResult] = useState(null);
  
  // ì¹´ë©”ë¼ë¡œ ì‚¬ì§„ ì°ê¸°
  const pickImage = async () => {
    const result = await ImagePicker.launchCameraAsync();
    if (!result.canceled) {
      classifyImage(result.assets[0].uri);
    }
  };
  
  // API í˜¸ì¶œí•˜ì—¬ ë¶„ë¥˜
  const classifyImage = async (uri) => {
    const formData = new FormData();
    formData.append('file', {
      uri: uri,
      name: 'image.jpg',
      type: 'image/jpeg'
    });
    
    const response = await fetch(
      'https://garbage-classifier-16970477973.asia-northeast3.run.app/predict',
      { method: 'POST', body: formData }
    );
    
    const data = await response.json();
    setResult(data.prediction); // ê²°ê³¼ í‘œì‹œ
  };
  
  return (
    <View>
      <Button title="ì‚¬ì§„ ì°ê¸°" onPress={pickImage} />
      {result && (
        <Text>ë¶„ë¥˜: {result.label} ({(result.score * 100).toFixed(1)}%)</Text>
      )}
    </View>
  );
}
```

## ğŸ“ í”„ë¡œì íŠ¸ êµ¬ì¡°

```
aimlops_garbage_classifier/
â”œâ”€â”€ main.py                 # FastAPI ë°±ì—”ë“œ ì„œë²„
â”œâ”€â”€ model.py                # AI ëª¨ë¸ ë¡œë“œ ë° ì¶”ë¡  ë¡œì§
â”œâ”€â”€ requirements.txt        # Python íŒ¨í‚¤ì§€ ëª©ë¡
â”œâ”€â”€ Dockerfile              # Docker ì´ë¯¸ì§€ ë¹Œë“œ ì„¤ì •
â”œâ”€â”€ cloudbuild.yaml         # Google Cloud Build ë°°í¬ ì„¤ì •
â”œâ”€â”€ web/                    # ì›¹ í”„ë¡ íŠ¸ì—”ë“œ (Vercel)
â”‚   â”œâ”€â”€ index.html
â”‚   â””â”€â”€ vercel.json
â”œâ”€â”€ mobile/                 # Expo ëª¨ë°”ì¼ ì•±
â”‚   â”œâ”€â”€ App.js
â”‚   â”œâ”€â”€ package.json
â”‚   â”œâ”€â”€ app.json
â”‚   â””â”€â”€ eas.json           # EAS Build ì„¤ì •
â””â”€â”€ README.md              # í”„ë¡œì íŠ¸ ë¬¸ì„œ
```

## ğŸ› ï¸ ê¸°ìˆ  ìŠ¤íƒ

### ë°±ì—”ë“œ
- **Python 3.11**: í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- **FastAPI**: ê³ ì„±ëŠ¥ REST API í”„ë ˆì„ì›Œí¬
- **Hugging Face Transformers**: AI ëª¨ë¸ ë¼ì´ë¸ŒëŸ¬ë¦¬
- **PyTorch**: ë”¥ëŸ¬ë‹ í”„ë ˆì„ì›Œí¬
- **Uvicorn**: ASGI ì›¹ ì„œë²„

### í”„ë¡ íŠ¸ì—”ë“œ
- **HTML/CSS/JavaScript**: ì›¹ ë°ëª¨
- **React Native (Expo)**: ëª¨ë°”ì¼ ì•±
- **expo-image-picker**: ì¹´ë©”ë¼/ê°¤ëŸ¬ë¦¬ ì ‘ê·¼

### ë°°í¬ ë° ì¸í”„ë¼
- **Google Cloud Run**: ì„œë²„ë¦¬ìŠ¤ ì»¨í…Œì´ë„ˆ ë°°í¬
- **Docker**: ì»¨í…Œì´ë„ˆí™”
- **Vercel**: ì •ì  ì›¹ í˜¸ìŠ¤íŒ…
- **Expo EAS Build**: ëª¨ë°”ì¼ APK ë¹Œë“œ

### MLOps
- **Hugging Face Hub**: ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©
- **Google Cloud Build**: CI/CD íŒŒì´í”„ë¼ì¸
- **Git/GitHub**: ë²„ì „ ê´€ë¦¬

## ğŸ“¦ ì„¤ì¹˜ ë° ì‹¤í–‰

### ë¡œì»¬ ê°œë°œ í™˜ê²½

```bash
# 1. ì €ì¥ì†Œ í´ë¡ 
git clone https://github.com/wldnreod/aimlops_garbage_classifier.git
cd aimlops_garbage_classifier

# 2. Python íŒ¨í‚¤ì§€ ì„¤ì¹˜
pip install -r requirements.txt

# 3. ì„œë²„ ì‹¤í–‰
python main.py
# ë˜ëŠ”
uvicorn main:app --reload

# 4. ë¸Œë¼ìš°ì €ì—ì„œ í™•ì¸
# http://localhost:8080
```

### Dockerë¡œ ì‹¤í–‰

```bash
# Docker ì´ë¯¸ì§€ ë¹Œë“œ
docker build -t garbage-classifier .

# ì»¨í…Œì´ë„ˆ ì‹¤í–‰
docker run -p 8080:8080 garbage-classifier

# API í…ŒìŠ¤íŠ¸
curl http://localhost:8080/health
```

### Cloud Run ë°°í¬

```bash
# Google Cloud í”„ë¡œì íŠ¸ ì„¤ì •
gcloud config set project my-project-720-476405

# Cloud Buildë¡œ ë°°í¬
gcloud builds submit --config cloudbuild.yaml

# ë˜ëŠ” ì§ì ‘ ë°°í¬
gcloud run deploy garbage-classifier \
  --source . \
  --region asia-northeast3 \
  --allow-unauthenticated
```

## ğŸ“± ëª¨ë°”ì¼ ì•± ë¹Œë“œ

```bash
# 1. mobile ë””ë ‰í† ë¦¬ë¡œ ì´ë™
cd mobile

# 2. íŒ¨í‚¤ì§€ ì„¤ì¹˜
npm install

# 3. EAS Buildë¡œ APK ìƒì„±
npx eas build -p android --profile preview

# 4. ìƒì„±ëœ APK ë‹¤ìš´ë¡œë“œ
# https://expo.dev/artifacts/eas/...
```

## ğŸ§ª í…ŒìŠ¤íŠ¸

### API í…ŒìŠ¤íŠ¸

```bash
# Health Check
curl https://garbage-classifier-16970477973.asia-northeast3.run.app/health

# ì´ë¯¸ì§€ ë¶„ë¥˜ í…ŒìŠ¤íŠ¸
curl -X POST "https://garbage-classifier-16970477973.asia-northeast3.run.app/predict" \
  -F "file=@test.jpg"
```

### Python í…ŒìŠ¤íŠ¸ ìŠ¤í¬ë¦½íŠ¸

```python
import requests

# ì´ë¯¸ì§€ íŒŒì¼ ì—…ë¡œë“œ
with open("test.jpg", "rb") as f:
    response = requests.post(
        "https://garbage-classifier-16970477973.asia-northeast3.run.app/predict",
        files={"file": f}
    )

print(response.json())
# {'success': True, 'prediction': {'label': 'cardboard', 'score': 0.85}}
```

## ğŸ”§ ì£¼ìš” ê¸°ëŠ¥ ìƒì„¸

### 1. ì´ë¯¸ì§€ ì „ì²˜ë¦¬
- **í¬ê¸° ì¡°ì •**: 224x224 í”½ì…€ë¡œ ë¦¬ì‚¬ì´ì¦ˆ
- **ì •ê·œí™”**: ImageNet í‰ê· /í‘œì¤€í¸ì°¨ë¡œ ì •ê·œí™”
- **í…ì„œ ë³€í™˜**: PIL Image â†’ PyTorch Tensor

### 2. AI ì¶”ë¡ 
- **ëª¨ë¸**: Vision Transformer ê¸°ë°˜
- **ì¶”ë¡  ì‹œê°„**: í‰ê·  200-300ms
- **ë°°ì¹˜ ì²˜ë¦¬**: ë‹¨ì¼ ì´ë¯¸ì§€ ì²˜ë¦¬

### 3. CORS ì²˜ë¦¬
- ì›¹/ëª¨ë°”ì¼ì—ì„œ API í˜¸ì¶œ ê°€ëŠ¥í•˜ë„ë¡ ì„¤ì •
- `Access-Control-Allow-Origin: *`
- OPTIONS preflight ìš”ì²­ ì§€ì›

## ğŸ“Š ì„±ëŠ¥

- **ì¶”ë¡  ì‹œê°„**: ~250ms/ì´ë¯¸ì§€
- **ëª¨ë¸ í¬ê¸°**: 343MB
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ~4GB (Cloud Run)
- **ë™ì‹œ ìš”ì²­ ì²˜ë¦¬**: Cloud Run auto-scaling

## ğŸ“ í•™ìŠµ ë‚´ìš©

ì´ í”„ë¡œì íŠ¸ë¥¼ í†µí•´ ë°°ìš´ ê²ƒë“¤:

1. **MLOps íŒŒì´í”„ë¼ì¸**: ëª¨ë¸ â†’ API â†’ ë°°í¬ ì „ ê³¼ì •
2. **Hugging Face ëª¨ë¸ í™œìš©**: ì‚¬ì „ í•™ìŠµëœ ëª¨ë¸ ì‚¬ìš©ë²•
3. **FastAPI**: Python ê¸°ë°˜ REST API êµ¬ì¶•
4. **Docker & Cloud Run**: ì»¨í…Œì´ë„ˆ ê¸°ë°˜ ë°°í¬
5. **CORS ì²˜ë¦¬**: ì›¹/ëª¨ë°”ì¼ í¬ë¡œìŠ¤ ì˜¤ë¦¬ì§„ ì´ìŠˆ í•´ê²°
6. **Expo Mobile**: React Native ì•± ê°œë°œ ë° APK ë¹Œë“œ

## ğŸ› íŠ¸ëŸ¬ë¸”ìŠˆíŒ…

### ë¬¸ì œ 1: AutoImageProcessor íŒ¨ë”© ì˜¤ë¥˜
**ì¦ìƒ**: `size should be a tuple (h, w)` ì—ëŸ¬  
**í•´ê²°**: torchvision.transforms ì§ì ‘ ì‚¬ìš©

### ë¬¸ì œ 2: CORS ì—ëŸ¬
**ì¦ìƒ**: ì›¹ì—ì„œ API í˜¸ì¶œ ì‹œ "No 'Access-Control-Allow-Origin' header"  
**í•´ê²°**: CORSMiddleware ì¶”ê°€ ë° OPTIONS í•¸ë“¤ëŸ¬ êµ¬í˜„

### ë¬¸ì œ 3: Expo SDK 50 ë¹Œë“œ ì‹¤íŒ¨
**ì¦ìƒ**: Gradle ë¹Œë“œ ì‹¤íŒ¨  
**í•´ê²°**: Expo SDK 49ë¡œ ë‹¤ìš´ê·¸ë ˆì´ë“œ

## ğŸ“ ë¼ì´ì„ ìŠ¤

MIT License

## ğŸ‘¥ ê°œë°œì

- GitHub: [@wldnreod](https://github.com/wldnreod)
- í”„ë¡œì íŠ¸: [aimlops_garbage_classifier](https://github.com/wldnreod/aimlops_garbage_classifier)

## ğŸ”— ì°¸ê³  ìë£Œ

- [Hugging Face Model Card](https://huggingface.co/yangy50/garbage-classification)
- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [Google Cloud Run Docs](https://cloud.google.com/run/docs)
- [Expo Documentation](https://docs.expo.dev/)
